ploidy: 2
pop_count: 3
pop_names:
- YRI
- CEU
- CHB
coalescence:
  entries:
  - {"epoch": 0, "deme": "YRI", "rate": {"param": 2}}
  - {"epoch": 0, "deme": "CEU", "rate": {"param": 4}}
  - {"epoch": 0, "deme": "CHB", "rate": {"param": 5}}
  - {"epoch": 1, "deme": "YRI", "rate": {"param": 2}}
  - {"epoch": 1, "deme": "CEU", "rate": {"param": 3}}
  - {"epoch": 2, "deme": "YRI", "rate": {"param": 2}}
  - {"epoch": 3, "deme": "YRI", "rate": {"param": 1}}
  parameters:
  - {"ground_truth": 6.84931506849315e-05, "lb": 1e-06, "ub": 0.01, "index": 1}
  - {"ground_truth": 4.065040650406504e-05, "lb": 1e-06, "ub": 0.01, "index": 2}
  - {"ground_truth": 0.0002380952380952381, "lb": 1e-06, "ub": 0.01, "index": 3}
  - {"ground_truth": 1.682066345910231e-05, "lb": 1e-06, "ub": 0.01, "index": 4}
  - {"ground_truth": 9.243796257772543e-06, "lb": 1e-06, "ub": 0.01, "index": 5}
growth:
  entries:
  - {"epoch": 0, "deme": "CEU", "rate": {"param": 1}}
  - {"epoch": 0, "deme": "CHB", "rate": {"param": 2}}
  parameters:
  - {"ground_truth": 0.004, "lb": 0.001, "ub": 0.05, "index": 1}
  - {"ground_truth": 0.0055, "lb": 0.001, "ub": 0.05, "index": 2}
migration:
  entries:
  - {"epoch": 0, "source": "YRI", "dest": "CEU", "rate": {"param": 2}}
  - {"epoch": 0, "source": "YRI", "dest": "CHB", "rate": {"param": 3}}
  - {"epoch": 0, "source": "CEU", "dest": "YRI", "rate": {"param": 2}}
  - {"epoch": 0, "source": "CEU", "dest": "CHB", "rate": {"param": 4}}
  - {"epoch": 0, "source": "CHB", "dest": "YRI", "rate": {"param": 3}}
  - {"epoch": 0, "source": "CHB", "dest": "CEU", "rate": {"param": 4}}
  - {"epoch": 1, "source": "YRI", "dest": "CEU", "rate": {"param": 1}}
  - {"epoch": 1, "source": "CEU", "dest": "YRI", "rate": {"param": 1}}
  parameters:
  - {"ground_truth": 0.00025, "lb": 1e-05, "ub": 0.01, "index": 1}
  - {"ground_truth": 3e-05, "lb": 1e-05, "ub": 0.01, "index": 2}
  - {"ground_truth": 1.9e-05, "lb": 1e-05, "ub": 0.01, "index": 3}
  - {"ground_truth": 9.6e-05, "lb": 1e-05, "ub": 0.01, "index": 4}
epochTimeSplit:
- {"ground_truth": 848.0, "lb": 100.0, "ub": 1200.0, "index": 1}
- {"ground_truth": 5600.0, "lb": 1200.0, "ub": 7200.0, "index": 2}
- {"ground_truth": 8800.0, "lb": 7200.0, "ub": 25000.0, "index": 3}
# Admixture occurs instantaneously at the beginning (backward in time) of the given epoch
admixture:
  entries: 
  - {"epoch": 1, "ancestral": "CEU", "derived": "CHB", "proportion": 1}
  - {"epoch": 2, "ancestral": "YRI", "derived": "CEU", "proportion": 1}

# For the admixture matrix, the row is the "derived" and the column is the "ancestral"
# Same for the admixture state matrix.
# Anything not listed as derived above, gets identity. That is, epoch0, p(YRI->YRI) = A[0, 0] = 1
#
# The admixture state matrix for this looks like:
#
#      00            01            02            11            12            22
#  00  A00*A00       2*A00*A01     2*A00*A02     A01*A01       2*(A01*A02)   A02*A02
#  01  A00*A10       (A00*A11)+(A01*A10)
#                    ^-- if there is any admixture from 0, this will be 0
#                        so we can just pick one of these.
#  02
#  11
#  12                              (A10*A22)+(A12*A20)
#  22  A20*A20       2*A20*A21     2*(A20*A22)

# We have ij -> kl
#
# The four cases are:
# if i == j:
#   if k == l:
#     v = A[i, k]*A[i, k]
#   else:
#     v = 2*A[i, k]*A[i, l]
# else:
#   if k == l:
#     v = A[i, k]*A[j, k]
#   else:
#     v = A[i, k]*A[j, l] + A[i, l]*A[j, k]
#         ^--- but one of these will be zero, based on admixture matrix input.
#
# So we ultimately have the form:
#   (c*A[x, y]*A[z, w]) that applies to a specific index (a, b) in the admixture state matrix.
#
# Given an admixture matrix A. Here, A[x, y] and A[z, w] correspond to a parameter from the input.
# So what we really have is:
#   (c*P_x*P_y) for parameters indexed x and y